<link rel="stylesheet" href="http://cache.amap.com/lbs/static/main.css?v=1.0"/>
<script type="text/javascript"
            src="http://webapi.amap.com/maps?v=1.3&key=ebb3310e602e7027987911af5e30be56"></script>

<div id='toolbar' style='font-size:2em'>
	    <button type="button" class="btn btn-primary" onclick='shopInfoChange()' >店铺信息修改</button>&nbsp;
	    <button type="button" class="btn btn-primary">关停店铺</button>&nbsp;
	    <button type="button" class="btn btn-primary">店铺搬家</button>
</div>
<div id="mapContainer" style='margin-top:86px;margin-left:12px;width:100%;height:600px'></div>
<script>
	 function shopInfoChange() {
		$('#myModala').modal('show');

	  // $.get('/home/shopMessage',function(reValue){
	 // alert(reValue);
  //     if(reValue!=''){
  //       $('#shopname').value= reValue.shopname;
  //       $('#shopintr').value= reValue.shopintr;
  //       $('#keywords').value= reValue.keywords;
  //       $('#photourl').value= reValue.photourl;
  //       $(goodsForm.typeid).val(reValue.typeid);

  //       //document.getElementById('checkimg').src='..'+reValue.goodsimg;
  //       //用jquery的方式从数据库中直接拿出数据
  //       //UE.getEditor('editor').setContent(reValue.goodsintro);
  //     }else{
  //       alert('数据库无此记录');
  //     }
   // });
      // goodsForm.action='/home/shopInfoRevise'
	
	}
	//初始化地图对象，加载地图
var map = new AMap.Map('mapContainer', {
	view: new AMap.View2D({
		center: new AMap.LngLat(<%-shopRs[0].lng%>, <%-shopRs[0].lat%>),
		zoom: 18
	})
});
var marker = new AMap.Marker({                 
		  map:map,                 
		  position: [<%-shopRs[0].lng%>, <%-shopRs[0].lat%>],  
		  title:"<%-shopRs[0].shopname%>",
		  icon:"http://webapi.amap.com/images/0.png",
		  offset:new AMap.Pixel(-10, -20)
	   });
marker.setLabel({
	        offset: new AMap.Pixel(-20, -20),
	        content: "<%-shopRs[0].shopname%>"
	    }); 

AMap.plugin(['AMap.ToolBar','AMap.Scale','AMap.OverView'],
    function(){
        map.addControl(new AMap.ToolBar());

        map.addControl(new AMap.Scale());

        map.addControl(new AMap.OverView({isOpen:true}));
});

function eventHandler(e){
	alert(e.lng);
	pubform.lng.value=e.lnglat.getLng();
	pubform.lat.value=e.lnglat.getLat();
	$('#myModal').modal('show');
}
//var listener = AMap.event.addListener(map,"click",eventHandler);
</script>

 <div class="modal fade" id="myModala" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
            <form name='pubform'  id='pubform' method='post' action='./pubshop' onsubmit='return onSubPub();' enctype="multipart/form-data">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title" id="myModalLabel">
                            填写营业点信息
                        </h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group" id='myform'>
                            <input type="text" class="form-control" id='shopname' name="shopname" placeholder="请输入营业点名称">

                            <textarea class="form-control" rows="5" placeholder="请输入营业简介" id='shopintr' name='shopintr'></textarea>
                            <input type="text" class="form-control" id='keywords' name='keywords' placeholder="请输入查询关键词">
                            <select class="form-control" name='shoptype' id='shoptype'>
                              <option value='0'>请选择经营类别</option>
                              <% shoptypeRs.forEach(function(row){ %>
                              <option value='<%-row.id%>'>
                              <%-row.typename%>
                              </option>
                              <%})%>
                            </select>
                            <label for="lastname" class="col-sm-2 control-label">店铺图片</label>
                            <input type="file" id="inputfile" name='photourl' id='photourl'>
                            <input type='hidden' name='lng'>
                            <input type='hidden' name='lat'>
                      </div>
                    </div>
                    <div class="modal-footer" style='text-align:center'>
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                        </button>
                        <input type="submit" class="btn btn-primary" onclick='dian();' value='提交'>
                        </input>
                    </div>
                </div><!-- /.modal-content -->
            </form>
            </div><!-- /.modal -->
        </div>